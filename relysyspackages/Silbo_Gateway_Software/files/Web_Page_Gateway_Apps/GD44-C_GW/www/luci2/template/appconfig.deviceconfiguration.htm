<script src="../view/appconfig.deviceconfiguration.js"></script>
<div>
     <div class="row">
        <div class="col-md-12">
            <button type="button" class="btn btn-primary" id="createdevice" data-toggle="modal" data-target="#exampleModal" style="float:right;margin: -40px 59px 10px 13px;">
                Add Device</button>
            <div id="map"></div>
        </div>
     </div>
     
  
        <!-- <button type="button" class="btn btn-primary" id="createdevice" data-toggle="modal" data-target="#exampleModal">
            Add Device</button> -->
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title" id="addtext">Update Device Configuration</h3>
                        <div>
                        </div>
                        <div id="navbar-example">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="nav-item active">
                                    <a class="nav-link active" data-toggle="tab" href="#communicationconfig"
                                        id="communicationid" role="tab">Parameters Configuration</a>
                                </li>


                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#registerconfig" id="register"
                                        role="tab">Register config</a>
                                </li>
                            </ul>


                            <div class="tab-content">
                                <div class="tab-pane active" id="communicationconfig" name="attributes" role="tabpanel">
                                    <form>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label id="requiredfield">DEVICE NAME</label>
                                                    <input type="text" name="Device Name" class="form-control inputbox" id="devicename"
                                                >
                                                </div>
                                            </div>
                                        </div>
                                    <div class="row" id="modbusserialconfig">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label id="requiredfield">Port number</label>
                                                <select name="port" id="serialport1" name="Port Number" class="form-control inputbox">
                                                    <option value="1">RS485 Port-1</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label id="requiredfield">Meter ID</label>
                                                <input type="number" class="form-control inputbox" name="Meter ID" id="equipmentid"
                                                    placeholder="1">
                                            </div>
                                            <div class="form-group">
                                                <label id="requiredfield">Meter Model</label>
                                                <input type="text" class="form-control inputbox" id="metermodel" name="Meter Model">
                                            </div>
                                            <div class="form-group">
                                                <label id="requiredfield">Function Code</label>
                                                <select name="function" id="functioncode" class="form-control" >
                                                    <option value="1">1</option>
                                                    <option value="2">2</option>
                                                    <option value="3">3</option>
                                                    <option value="4">4</option>
                                                </select>
                                            </div>

                                            <div class="form-group">
                                                <label id="requiredfield">Slave Address</Address></label>
                                                <input type="number" class="form-control inputbox" id="serialslaveid"
                                                    placeholder="1-255" name="Slave Address">
                                            </div>
                                        </div>

                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label id="requiredfield">Modbus Protocol</label>
                                                  
                                                <select name="Protocol" id="protocol" class="form-control"
                                                    onchange="toggleParity()">
                                                    <option value="RTU">RTU</option>
                                                    <option value="TCP">TCP</option>
                                                </select>
                                            </div>

                                            <div class="form-group" id="tcpOptions" style="display: none;">
                                                <label id="requiredfield">Modbus Comm IP:</label>
                                                <input type="text" name="Modbus Comm IP" id="CommIp" class="form-control inputbox">

                                                <label id="requiredfield">Modbus Comm Port:</label>
                                                <input type="number" name="Modbus Comm Port" id="CommPort" class="form-control inputbox">

                                                <label id="requiredfield">Modbus Comm Timeout:</label>
                                                <input type="number" name="Modbus Comm Timeout" id="commT" class="form-control inputbox">
                                            </div>

                                            <div id="RTUOptions">

                                           
                                            <div class="form-group" id="parityGroup1">
                                                <label id="requiredfield">Baud rate</label>
                                                <select name="Baudrate" id="serialbaudrate" class="form-control">
                                                    <option value="9600">9600</option>
                                                    <option value="300">300</option>
                                                    <option value="1200">1200</option>
                                                    <option value="1800">1800</option>
                                                    <option value="2400">2400</option>
                                                    <option value="4800">4800</option>
                                                    <option value="19200">19200</option>
                                                    <option value="38400">38400</option>
                                                </select>
                                            </div>
                                            <div class="form-group" id="parityGroup2">
                                                <label id="requiredfield">Parity</label>
                                                <select name="parity" id="serialparity" class="form-control">
                                                    <option value="0">0-NONE</option>
                                                    <option value="1">1-ODD</option>
                                                    <option value="2">2-EVEN</option>
                                                </select>
                                            </div>
                                            <div class="form-group" id="parityGroup3">
                                                <label id="requiredfield">No.of Databits</label>
                                                <select name="databits" id="serialdatabits" class="form-control">
                                                    <option value="7">7</option>
                                                    <option value="8">8</option>
                                                </select>
                                            </div>
                                            <div class="form-group" id="parityGroup4">
                                                <label id="requiredfield">No.of Stopbits</label>
                                                <select name="cars" id="serialstopbit" class="form-control">
                                                    <option value="1">1</option>
                                                    <option value="2">2</option>
                                                </select>
                                            </div>
                                        </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label id="requiredfield">Start Register</label>
                                                <input type="number" class="form-control inputbox" name="Start Register" id="startregisteru">
                                            </div>
                                            <div class="form-group">
                                                <label id="requiredfield">No.of Register</label>
                                                <input type="number" class="form-control inputbox" name="No. of Register" id="countregister">
                                            </div>
                                        </div>
                                        
                                    </div>


                                </form>
                                </div>
                                <div class="row" id="modbustcpconfig">
                                </div>

                                <div class="tab-pane" id="registerconfig" role="tabpanel">

                                    <!-- Checkbox Row -->
                                    <div class="row" style="margin-bottom:10px">
                                        <div class="col-md-3">
                                            <input type="checkbox" id="Default" checked/>
                                            <label>Default Mapping</label>
                                        </div>
                                        <div class="col-md-3">
                                            <input type="checkbox" id="Custom" />
                                            <label>Custom Mapping</label>
                                        </div>
                                      
                                      </div>
                                      
                                   
                                      

                                        <div class="row modusregister additional-inputs" id="defaultMappingInputs"
                                            style="width: 80%;">
                                            <div class="col-md-2" style="display: block;">
                                                <label id="tagNameLabel">Tag Name </label>
                                                <input type='textbox' id='tagNameInput' class="form-control">
                                            </div>
                                            <div class="col-md-2">
                                                <label id="tagNAMEdata">Data Type</label>
                                                <select type='textbox' id='TagDatatype' class="form-control">
                                                    <option value="0">Hexdecimal</option>
                                                    <option value="1">32 bit Floating Point</option>
                                                    <option value="2">32 bit Floating Point(Swapped byte)</option>
                                                    <option value="3">16 bit UINT (high byte first)</option>
                                                    <option value="4">16 bit UINT (low byte first)</option>
                                                    <option value="5">16 bit INT (high byte first)</option>
                                                    <option value="6">16 bit INT (low byte first)</option>
                                                    <option value="7">32 bit UINT (byte order 1,2,3,4)</option>
                                                    <option value="8">32 bit UINT ( byte order 4,3,2,1)</option>
                                                    <option value="9">32 bit INT (byte order 1,2,3,4)</option>
                                                    <option value="10">32 bit INT (byte order 4,3,2,1)</option> 
                                                    <option value="11">1 bit</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div id='TextBoxesGroup' class="tab-pane" style="display: none;">

                                            <!-- Custom Mapping Options -->
                                            <div class="row modusregister custom-mapping" >
                                                <div class="col-md-2">
                                                    <label id="requiredfieldN">Register Name</label>
                                                    <input type='textbox' id='registername0' class="form-control">
                                                </div>
                                                <div class="col-md-2">
                                                    <label id="requiredfieldSR">Start Register</label>
                                                    <input type='textbox' id='startregister0' class="form-control">
                                                </div>
                                                <div class="col-md-2">
                                                    <label id="requiredfieldCount">Register Count</label>
                                                    <input type='textbox' id='registercount0' class="form-control">
                                                </div>
                                                <div class="col-md-2">
                                                    <label id="requiredfieldDT">Data Type</label>
                                                    <select type='textbox' id='Datatype0' class="form-control">
                                                        <option value="">Select</option>
                                                        <option value="0">Hexdecimal</option>
                                                        <option value="1">32 bit Floating Point</option>
                                                        <option value="2">32 bit Floating Point(Swapped byte)</option>
                                                        <option value="3">16 bit UINT (high byte first)</option>
                                                        <option value="4">16 bit UINT (low byte first)</option>
                                                        <option value="5">16 bit INT (high byte first)</option>
                                                        <option value="6">16 bit INT (low byte first)</option>
                                                        <option value="7">32 bit UINT (byte order 1,2,3,4)</option>
                                                        <option value="8">32 bit UINT ( byte order 4,3,2,1)</option>
                                                        <option value="9">32 bit INT (byte order 1,2,3,4)</option>
                                                        <option value="10">32 bit INT (byte order 4,3,2,1)</option>
                                                        <option value="11">1 bit</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-2">
                                                    <input type='button' value='Delete' id='removeButton'
                                                        class="btn btn-primary" style="margin-top: 22px;">
                                                </div>

                                            </div>
                                       </div>
                                      <div class="row">
                                        <div class="col-md-9">
                                            <div class="form-group">
                                                <textarea class="form-control" disabled style="margin-top:15px;resize: none;display: none;" cols="12" rows="4" id="jsoninfo"></textarea>
                                            </div>
                                           
                                        </div>
                                       
                                        <!-- <div id="jsoninfo" class="panel-default"></div> -->
                                      </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-success" id='addButton' disabled
                            onclick="Add()">Add</button>
                            <button type="button" class="btn btn-info" id='addButton'
                            onclick="showJson()">Show JSON</button>
                        <input type="button" value="Add Device" class="btn btn-primary" id="AddNewEvent">
                    </div>
                </div>

            </div>

        </div>
    
</div>


<style>
    #deviceid {
        width: 132px;
        color: white;
        height: 40px;
        background: #13557E 0% 0% no-repeat padding-box;
        box-shadow: 0px 3px 6px #00000029;
        border-radius: 5px;
        opacity: 1;
        font: normal normal normal 16px/25px Poppins;
    }

    .cbi-section {
        width: 95%;
        margin-bottom: 10px;
    }

    .table {
        border: 1px solid #dddd;
    }

    td,
    th {
        border: 1px solid #dddd;

    }

    .modal-dialog {
        width: 1065px;
    }

    #requiredfield::after {
        content: " *";
        color: red;
    }

    label {
        font: normal normal normal 14px/16px Poppins;
        color: #000000;
    }

    /* #modbustcpconfig, */
    #modustcpregister {
        display: none;
    }

    .newinput {
        margin-top: 5px;
    }

    .table {
        width: 114.3%;
    }

    #updatetext,
    #updatedevice {
        display: none;
    }

    #TextBoxesGroup {
        background: #ffffff;
        overflow-y: auto;
        overflow-x: hidden;
        /* width: 221px; */
        /* -webkit-box-shadow: inset 0 0 6px rgb(0 0 0 / 30%); */
    }

    .switch {
        position: relative;
        display: inline-block;
        width: 40px;
        height: 22px;
    }

    .switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        -webkit-transition: .4s;
        transition: .4s;
    }

    .slider:before {
        position: absolute;
        content: "";
        height: 18px;
        width: 18px;
        left: 2px;
        bottom: 2px;
        background-color: white;
        -webkit-transition: .4s;
        transition: .4s;
    }

    input:checked+.slider {
        background-color: #2196F3;
    }

    input:focus+.slider {
        box-shadow: 0 0 1px #2196F3;
    }

    input:checked+.slider:before {
        -webkit-transform: translateX(18px);
        -ms-transform: translateX(18px);
        transform: translateX(18px);
    }

    

    /* Rounded sliders */
    .slider.round {
        border-radius: 34px;
    }

    .slider.round:before {
        border-radius: 50%;
    }

    .btn-group>.btn:first-child:not(:last-child):not(.dropdown-toggle) {
        margin-right: 8px;
        padding: 4.9px 20px;
        border-radius: 4px;
    }

    .btn-group>.btn:last-child:not(:first-child),
    .btn-group>.dropdown-toggle:not(:first-child) {
        border-radius: 4px;
    }

    #communicationid {
        text-align: center !important;
    }

    #serialmqtt,
    #tcpmqtt,
    #tcpqueryinterval {
        text-align: center !important;

    }

    #tcpOptions {
        display: none;
    }

    #tcpOptions label {
        display: block;
        margin-bottom: 5px;
    }

    #tcpOptions input {
        width: 100%;
        /* Make the input fields take up 100% of the container width */
        box-sizing: border-box;
        /* Include padding and border in the element's total width */
        margin-bottom: 10px;
    }
</style>


<script>

  
    


    
    document.getElementById("serialslaveid").onkeyup = function () {
        var input = parseInt(this.value);
        console.log(input)
        if(input==NaN){
            $("#serialslaveid").val("");
        }
        else{
            if (input < 1 || input > 255) {
            $("#serialslaveid").val("");
            return;
        }
        }
    }

    document.getElementById("CommPort").onkeyup = function () {
        var input = parseInt(this.value);
        console.log(input)
        if(input==NaN){
            $("#CommPort").val("");
        }
        else{
            if (input < 1 || input > 6555) {
            $("#CommPort").val("");
            return;
        }
        }
    }


    
    $('#CommIp').inputmask({
        alias: "ip",
        greedy: false
    });
   


</script>
